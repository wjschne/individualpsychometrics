<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Individual Psychometrics – 10&nbsp; Composite Scores</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./unfinished.html" rel="next">
<link href="./descriptives.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="equity.css">
</head>
<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./variables.html">Variables</a></li><li class="breadcrumb-item"><a href="./compositescores.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Composite Scores</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Individual Psychometrics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gettingready.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Ready to Use R via RStudio</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./matrix_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix Algebra in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scalars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Scalars</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrices_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Matrices–Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrices_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrices–Operations</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Variables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Descriptives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./compositescores.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Composite Scores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unfinished.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Unfinished Odds and Ends</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
    <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Page Contents</h2>
   
  <ul>
<li>
<a href="#the-mean-of-the-sum-is-the-sum-of-the-means" id="toc-the-mean-of-the-sum-is-the-sum-of-the-means" class="nav-link active" data-scroll-target="#the-mean-of-the-sum-is-the-sum-of-the-means"><span class="header-section-number">10.1</span> The Mean of the Sum Is the Sum of the Means</a>
  <ul class="collapse">
<li><a href="#calculating-a-sum" id="toc-calculating-a-sum" class="nav-link" data-scroll-target="#calculating-a-sum"><span class="header-section-number">10.1.1</span> Calculating a Sum</a></li>
  <li><a href="#calculating-the-mean-of-a-sum" id="toc-calculating-the-mean-of-a-sum" class="nav-link" data-scroll-target="#calculating-the-mean-of-a-sum"><span class="header-section-number">10.1.2</span> Calculating the Mean of a Sum</a></li>
  <li><a href="#calculating-the-mean-of-a-weighted-sum" id="toc-calculating-the-mean-of-a-weighted-sum" class="nav-link" data-scroll-target="#calculating-the-mean-of-a-weighted-sum"><span class="header-section-number">10.1.3</span> Calculating the Mean of a Weighted Sum</a></li>
  </ul>
</li>
  <li><a href="#the-variance-of-the-sum-is-the-sum-of-the-covariance-matrix" id="toc-the-variance-of-the-sum-is-the-sum-of-the-covariance-matrix" class="nav-link" data-scroll-target="#the-variance-of-the-sum-is-the-sum-of-the-covariance-matrix"><span class="header-section-number">10.2</span> The Variance of the Sum Is the Sum of the Covariance Matrix</a></li>
  <li><a href="#calculating-the-variance-of-a-weighted-sum" id="toc-calculating-the-variance-of-a-weighted-sum" class="nav-link" data-scroll-target="#calculating-the-variance-of-a-weighted-sum"><span class="header-section-number">10.3</span> Calculating the Variance of a Weighted Sum</a></li>
  <li>
<a href="#calculating-a-composite-score" id="toc-calculating-a-composite-score" class="nav-link" data-scroll-target="#calculating-a-composite-score"><span class="header-section-number">10.4</span> Calculating a Composite Score</a>
  <ul class="collapse">
<li><a href="#calculating-a-weighted-composite-score" id="toc-calculating-a-weighted-composite-score" class="nav-link" data-scroll-target="#calculating-a-weighted-composite-score"><span class="header-section-number">10.4.1</span> Calculating a Weighted Composite Score</a></li>
  </ul>
</li>
  <li><a href="#the-reliability-coefficient-of-a-composite" id="toc-the-reliability-coefficient-of-a-composite" class="nav-link" data-scroll-target="#the-reliability-coefficient-of-a-composite"><span class="header-section-number">10.5</span> The Reliability Coefficient of a Composite</a></li>
  <li><a href="#composite-scores-and-their-correlations" id="toc-composite-scores-and-their-correlations" class="nav-link" data-scroll-target="#composite-scores-and-their-correlations"><span class="header-section-number">10.6</span> Composite Scores and Their Correlations</a></li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./variables.html">Variables</a></li><li class="breadcrumb-item"><a href="./compositescores.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Composite Scores</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Composite Scores</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="page-columns page-full"><p>Clinicians use <span class="defword">composite scores</span> whenever they can because they tend to be more reliable and valid than single scores. How much more reliable is a composite score than a single score? It, of course, depends. First, the reliability coefficients of all of the scores that make up the composite score matter. Second, the correlations among the components of the composite matter. The more reliable and correlated the components, the more reliable the composite.</p><div class="no-row-height column-margin column-container"><span class="defword">A <strong>composite variable</strong> is the (possibly weighted) sum of two or more variables.</span></div></div>
<p>As discussed previously, it is quite possible for different scores from the same test to have different reliability coefficients. Scores from the same test tend to have similar reliability coefficients, though it is quite possible for differences in reliability to be large. In a well designed test, such cases are rare. If we can assume that the test is well designed and that test score reliability coefficients are within a fairly narrow range, we can assume that the classical reliability coefficient is a good estimate of the reliability of all scores from a particular test. To the degree that such assumptions are incorrect, the following equations will be less accurate.</p>
<p>Before we can discuss the reliability of composites, we must cover more basic statistics as they apply to composite scores. I will present this material in three ways. First, I will show the equations in standard notation. Adjacent to this, I will show the same equations in matrix notation.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Then I will walk through the calculations using R.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Why bother with matrices? It does seem to be an unnecessary complication at first. However, many things become clearer and simpler with matrices, which I hope to illustrate. Furthermore, R was designed to work elegantly with vectors and matrices.</p></div></div><section id="the-mean-of-the-sum-is-the-sum-of-the-means" class="level2 page-columns page-full" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="the-mean-of-the-sum-is-the-sum-of-the-means">
<span class="header-section-number">10.1</span> The Mean of the Sum Is the Sum of the Means</h2>
<p>This section is going to make a simple idea look complicated. If you get lost, this is what I am trying to say:</p>
<blockquote class="blockquote">
<p>If we create a new random variable by adding a bunch of random variables together, the mean of that new variable is found by adding together the means of all the variables we started with.</p>
</blockquote>
<p>I’m sorry for what comes next, but the work we put into it will pay off later. Okay, now let’s make that simple idea formal and hard to understand:</p>
<p>We can start with the example of two variables: <span class="math inline">X_1</span> and <span class="math inline">X_2.</span> The sum of these variables, which we will call <span class="math inline">X_S</span>, has a mean, which is the sum of the means of <span class="math inline">X_1</span> and <span class="math inline">X_2.</span> That is, <span class="math inline">\mu_{S}=\mu_{1}+\mu_{2}.</span></p>
<p>What if we have three variables? or four? or five? It would be tedious to illustrate each case one by one. We need a way of talking about the sum of a bunch of random variables but without worrying about how many variables there are. Here we go:</p>
<section id="calculating-a-sum" class="level3 page-columns page-full" data-number="10.1.1"><h3 data-number="10.1.1" class="anchored" data-anchor-id="calculating-a-sum">
<span class="header-section-number">10.1.1</span> Calculating a Sum</h3>
<p>Suppose <span class="math inline">k</span> is a positive integer greater than 1. So if there are <span class="math inline">k</span> random variables, the notation for the set of all them is <span class="math inline">\{X_1,...,X_k\}.</span> However, it is even more compact to use matrix notation such that <span class="math inline">\boldsymbol{X}=\{X_1,...,X_k\}.</span></p>
<p>Now, <span class="math inline">\boldsymbol{X}</span> is a set of random variables in their entirety, without referencing any particular values those variables might generate. A set of particular values of these variables would be shown as <span class="math inline">\boldsymbol{x}</span> or <span class="math inline">\{x_1,...,x_k\}.</span> In regular notation, the sum of these particular values would be:</p>
<p><span class="math display">x_S=\sum_{i=1}^{k}{x_i}</span></p>
<div class="cell fig-cap-location-margin" data-layout-align="center" data-tbl-colwidths="[20,80]">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 90%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">x_S</span></td>
<td style="text-align: left;">The sum of all <span class="math inline">k</span> scores in <span class="math inline">\{x_1,...,x_k\}</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">x_i</span></td>
<td style="text-align: left;">A particular score generated by variable <span class="math inline">X_i</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">k</span></td>
<td style="text-align: left;">The number of variables in <span class="math inline">\{X_1,...,X_k\}</span>, <span class="math inline">(k \in \mathbb{N}_1)</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The same formula is more compact in matrix notation:</p>
<p><span class="math display">
x_S=\boldsymbol{x'1}
</span></p>
<p>Where</p>
<div class="cell fig-cap-location-margin" data-layout-align="center" data-tbl-colwidths="[20,80]">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\boldsymbol{x}</span></td>
<td style="text-align: left;">A <span class="math inline">k \times 1</span> vector of scores <span class="math inline">\{x_1,x_2,...,x_k\}</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\boldsymbol{1}</span></td>
<td style="text-align: left;">A <span class="math inline">k \times 1</span> vector of ones <span class="math inline">\{1_1,1_2,...,1_k\}</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <span class="math inline">\boldsymbol{1}</span> symbol may be a bit confusing. It is a column of ones that has the same length (number of elements) as <span class="math inline">\boldsymbol{x}.</span> Suppose that <span class="math inline">\boldsymbol{x}</span> has a length of three. In this case:</p>
<p><span class="math display">\boldsymbol{1}_3=\begin{bmatrix}1\\ 1\\ 1 \end{bmatrix}</span></p>
<div class="page-columns page-full"><p>Also, <span class="math inline">\boldsymbol{x'}</span>, is <span class="math inline">\boldsymbol{x}</span> <span class="defword">transposed</span>.</p><div class="no-row-height column-margin column-container"><span class="defword">To <strong>transpose</strong> means to make all columns of a matrix into rows (or all rows into columns).</span></div></div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Transposition is noted with a prime symbol <span class="math inline">(\boldsymbol{^\prime})</span>. If</p>
<p><span class="math display">
\boldsymbol{A}= \begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6\\
\end{bmatrix}
</span> then</p>
<p><span class="math display">
\boldsymbol{A'}= \begin{bmatrix}
1 &amp; 4\\
2 &amp; 5\\
3 &amp; 6\\
\end{bmatrix}
</span></p>
<p>A column of 3 ones:</p>
<p><span class="math display">
\boldsymbol{1}_3=\begin{bmatrix}1\\1\\1\end{bmatrix}
</span></p>
<p>Transposed, a column of 2 ones is a row of 2 ones.</p>
<p><span class="math display">
\boldsymbol{{1'}}_2=\begin{bmatrix}1&amp;1\end{bmatrix}
</span></p>
<p>Typically, the number of ones is implied such that the length of the column or row will be compatible with the adjacent matrix. For example, post-multiplying by a vector ones will create a vector of row totals:</p>
<p><span class="math display">
\begin{align*}
\boldsymbol{A1}&amp;=\begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6\\
\end{bmatrix}\begin{bmatrix}1\\1\\1\end{bmatrix}\\
&amp;=\begin{bmatrix}1+2+3\\4+5+6\end{bmatrix}\\
&amp;=\begin{bmatrix}6\\15\end{bmatrix}
\end{align*}
</span></p>
<p>Pre-multiplying by a vector of ones will create column totals:</p>
<p><span class="math display">
\begin{align*}
\boldsymbol{1'A}&amp;=\begin{bmatrix}1\\1\end{bmatrix}'\begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6\\
\end{bmatrix}\\
&amp;=\begin{bmatrix}1&amp;1\end{bmatrix}\begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6\\
\end{bmatrix}\\
&amp;=\begin{bmatrix}1+4 &amp; 2+5 &amp; 3+6\end{bmatrix}\\&amp;=\begin{bmatrix}5 &amp; 7 &amp; 9\end{bmatrix}
\end{align*}
</span></p>
<p>To create a sum of the entire matrix, multiply by <span class="math inline">\boldsymbol{1}</span> on both sides:</p>
<p><span class="math display">\boldsymbol{1'A1}=21</span></p>
</div></div><p>Therefore, <span class="math inline">\boldsymbol{x'}</span> is a row vector. A row vector multiplied by a column vector is the sum of the product of each analogous element in the pair of vectors. Thus,</p>
<p><span class="math display">
\begin{align*}
\boldsymbol{x'1}&amp;=\begin{bmatrix} x_1\\ x_2\\ x_3 \end{bmatrix}'
\begin{bmatrix}1\\ 1\\ 1 \end{bmatrix} \\
&amp;=\begin{bmatrix} x_1 &amp; x_2 &amp; x_3\end{bmatrix}
\begin{bmatrix}1\\ 1\\ 1\end{bmatrix}\\
&amp;=x_1 \times 1 + x_2 \times 1 + x_3 \times 1\\
&amp;=  x_1 + x_2 + x_3
\end{align*}
</span></p>
<p>Let’s do some calculations in R with a particular example. Suppose that there are three variables: <span class="math inline">\boldsymbol{X}=\{X_1, X_2, X_3\}.</span> In R, we will create a vector of the names of variables in <span class="math inline">\boldsymbol{X}</span>:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb1" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Xnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span><span class="op">)</span></span>
<span><span class="co"># Notes:</span></span>
<span><span class="co"># Xnames is a vector of variable names</span></span>
<span><span class="co"># The c function combines numbers (or other objects) into a vector.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now suppose that there are three particular scores: <span class="math inline">\boldsymbol{x}=\{100,120,118\}</span></p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb2" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># x = vector of particular scores from variables X1, X2, X3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">110</span>,<span class="fl">120</span>,<span class="fl">118</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Applying Xnames to x (to make output easier to read)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">Xnames</span> </span>
<span></span>
<span><span class="co"># Notes: </span></span>
<span><span class="co"># The `names` function returns or sets the names of vector elements.</span></span>
<span><span class="co"># We can set names and values in a single line like so:</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>X1 <span class="op">=</span> <span class="fl">110</span>, X2 <span class="op">=</span> <span class="fl">120</span>, X3 <span class="op">=</span> <span class="fl">118</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sum of these three scores can be calculated in a variety of ways. Here is the easiest:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb3" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># x_S = The sum of scores x1, x2, and x3</span></span>
<span><span class="va">x_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, if we want to be matrix algebra masochists (and, apparently, at least one of us does!), we could do this:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb4" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># A vector of ones the same length as x</span></span>
<span><span class="va">ones</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Notes: </span></span>
<span><span class="co"># The rep function creates vectors of repeated elements. </span></span>
<span><span class="co"># For example, rep(5,3) is the same as c(5,5,5).</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># The length function returns the number of elements in a vector. </span></span>
<span><span class="co"># For example, length(c(3,3)) returns `2`.</span></span>
<span></span>
<span></span>
<span><span class="co"># Calculating x_S with matrix algebra</span></span>
<span><span class="va">x_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">ones</span></span>
<span></span>
<span><span class="co"># Notes: </span></span>
<span><span class="co"># The t function transposes a vector or matrix.</span></span>
<span><span class="co"># The operator %*% multiplies compatible matrices.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Either way that we calculate it, <span class="math inline">x_S = 348.</span></p>
</section><section id="calculating-the-mean-of-a-sum" class="level3" data-number="10.1.2"><h3 data-number="10.1.2" class="anchored" data-anchor-id="calculating-the-mean-of-a-sum">
<span class="header-section-number">10.1.2</span> Calculating the Mean of a Sum</h3>
<p>The mean of <span class="math inline">X_S</span> is:</p>
<p><span class="math display">
\mu_{S}=\sum_{i=1}^{k}{\mu_i}=\boldsymbol{\mu'1}
</span></p>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 78%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\mu_S</span></td>
<td style="text-align: left;">The mean of <span class="math inline">X_S</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\mu_i</span></td>
<td style="text-align: left;">The mean of <span class="math inline">X_i</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\boldsymbol{\mu}</span></td>
<td style="text-align: left;">A <span class="math inline">k \times 1</span> vector of means of the variables in <span class="math inline">\boldsymbol{X}</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Suppose that the means of <span class="math inline">X_1</span>, <span class="math inline">X_2</span>, and <span class="math inline">X_3</span> are all 100.</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb5" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># m = vector of means of X</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again, the mean of <span class="math inline">X_S</span> <span class="math inline">(\mu_S)</span> can be calculated in two ways:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb6" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># m_S = The mean of S</span></span>
<span><span class="co"># The easy way</span></span>
<span><span class="va">m_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With matrix algebra</span></span>
<span><span class="va">m_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">ones</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running this code, we can see that <span class="math inline">\mu_S = 300.</span></p>
</section><section id="calculating-the-mean-of-a-weighted-sum" class="level3 page-columns page-full" data-number="10.1.3"><h3 data-number="10.1.3" class="anchored" data-anchor-id="calculating-the-mean-of-a-weighted-sum">
<span class="header-section-number">10.1.3</span> Calculating the Mean of a Weighted Sum</h3>
<p>The mean of a weighted sum is the weighted sum of the means. That is, if</p>
<p><span class="math display">\begin{equation}
x_S=\sum_{i=1}^{k}{x_i w_i}=\boldsymbol{x'w}
\end{equation}</span></p>
<p>Where</p>
<p>then</p>
<p><span class="math display">\begin{equation}
\mu_S=\sum_{i=1}^{k}{\mu_i w_i}=\boldsymbol{\mu'w}
\end{equation}</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Note that the calculation of <span class="math inline">X_S</span> and <span class="math inline">\mu_S</span> with matrix algebra is the same as it was with an equally weighted sum except that instead of post-multiplying by a vector of ones <span class="math inline">(\boldsymbol{x^\prime 1})</span>, we post-multiply by a vector of weights <span class="math inline">(\boldsymbol{x^\prime w}).</span> In truth, an equally weighted sum is a special case of a weighted sum in which <span class="math inline">\boldsymbol{w}</span> consists entirely of ones.</p>
</div></div><p>Suppose that <span class="math inline">\boldsymbol{w} = \{0.5,1,2\}.</span> That is, the weight for <span class="math inline">X_1</span> is 0.5, the weight for <span class="math inline">X_2</span> is 1, and the weight for <span class="math inline">X_3</span> is 2. We will continue to use the same values for <span class="math inline">\boldsymbol{x}</span> and <span class="math inline">\boldsymbol{\mu}</span> as before:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb7" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># w = The vector of weight for variables X1, X2, and X3</span></span>
<span><span class="va">w</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The easy way</span></span>
<span><span class="va">x_S_weighted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="va">w</span><span class="op">)</span></span>
<span><span class="va">m_S_weighted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">m</span> <span class="op">*</span> <span class="va">w</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Notes:</span></span>
<span><span class="co"># The multiplication operator * multiplies analogous elements </span></span>
<span><span class="co"># of vectors  and matrices. In the example, `x * w` is </span></span>
<span><span class="co"># c(110 * 0.5, 120 * 1, 118 * 2)</span></span>
<span></span>
<span><span class="co"># With matrix algebra</span></span>
<span><span class="va">x_S_weighted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">w</span></span>
<span><span class="va">m_S_weighted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">w</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running the code shows that <span class="math inline">x_S = 411</span> and that <span class="math inline">\mu_S = 350.</span></p>
</section></section><section id="the-variance-of-the-sum-is-the-sum-of-the-covariance-matrix" class="level2 page-columns page-full" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="the-variance-of-the-sum-is-the-sum-of-the-covariance-matrix">
<span class="header-section-number">10.2</span> The Variance of the Sum Is the Sum of the Covariance Matrix</h2>

<div class="no-row-height column-margin column-container"><div class="">
<p>Unfortunately, the notation for a covariance matrix is a bold capital sigma <span class="math inline">\boldsymbol{\Sigma}</span>, which is easily confused with the summation symbol, which is generally larger and not bold: <span class="math inline">\sum.</span></p>
</div></div><p>If variables are uncorrelated, the variance of their sum is the sum of their variances. However, this is not true when variables are substantially correlated. The formula for the variance of a sum looks more complex than it is. It is just the sum of the covariance matrix.</p>
<p><span class="math display">
\sigma_{X_S}^2=\sum_{i=1}^{k}{\sum_{j=1}^{k}{\sigma_{ij}}}=\boldsymbol{1'\Sigma 1}
(\#eq:VarianceOfASum)
</span></p>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 77%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\sigma_{X_S}^2</span></td>
<td style="text-align: left;">The variance of <span class="math inline">X_S</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\sigma_{ij}</span></td>
<td style="text-align: left;">The covariance between <span class="math inline">X_i</span> and <span class="math inline">X_j</span> <span class="math inline">(\sigma_{ij}=\sigma_i^2</span> if <span class="math inline">i=j)</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\boldsymbol{\Sigma}</span></td>
<td style="text-align: left;">The <span class="math inline">k \times k</span> covariance matrix of all the variables in <span class="math inline">\boldsymbol{X}</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>The symbol for a sample correlation is the Roman lowercase <span class="math inline">r</span>, and a matrix of such correlations is an uppercase <span class="math inline">\boldsymbol{R}.</span> Therefore, the population correlation coefficient is a Greek lowercase rho: <span class="math inline">\rho.</span> This, unfortunately means that a matrix of correlations should be an uppercase rho: <span class="math inline">\boldsymbol{P}.</span> Somehow, statisticians are okay with <span class="math inline">\rho</span> looking a lot like an italicized Roman letter <em>p</em>. However, using an uppercase rho <span class="math inline">(\boldsymbol{P})</span> for a correlation matrix is too weird even for statisticians! You know, hobgoblins of little minds and all…</p>
</div></div><p>Suppose that the standard deviations of <span class="math inline">X_1</span>, <span class="math inline">X_2</span>, and <span class="math inline">X_3</span> are all 15. Thus, <span class="math inline">\sigma=\{15,15,15\}.</span> The correlations among the three variables are shown in matrix <span class="math inline">\boldsymbol{R}</span>:</p>
<p><span class="math display">
\boldsymbol{R} = \begin{bmatrix}
1 &amp; 0.5 &amp; 0.6\\
0.5 &amp; 1 &amp; 0.7\\
0.6 &amp; 0.7 &amp; 1
\end{bmatrix}
</span></p>
<p>To create this matrix in R:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb8" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># R = correlation matrix of variables in X</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, </span>
<span>              <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0.7</span>,  </span>
<span>              <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>     [,1] [,2] [,3]
[1,]  1.0  0.5  0.6
[2,]  0.5  1.0  0.7
[3,]  0.6  0.7  1.0</code></pre>
</div>
</div>
<p>The covariance matrix <span class="math inline">\boldsymbol{\Sigma}</span> can be computed from the correlation matrix and the standard deviations like so:</p>
<p><span class="math display">
\sigma_{ij} = \sigma_{i} \sigma_{j} \rho_{ij}
</span></p>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\sigma_{ij}</span></td>
<td style="text-align: left;">The covariance between <span class="math inline">X_i</span> and <span class="math inline">X_j</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\rho_{ij}</span></td>
<td style="text-align: left;">The correlation between <span class="math inline">X_i</span> and <span class="math inline">X_j</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\sigma_{i}</span></td>
<td style="text-align: left;">The standard deviation of variable <span class="math inline">X_i</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\sigma_{j}</span></td>
<td style="text-align: left;">The standard deviation of variable <span class="math inline">X_j</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Unfortunately, computing a covariance matrix like this in a computer program is inelegant because we have to make use of looping:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb10" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># R = Correlation matrix of variables in X</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,</span>
<span>              <span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">0.7</span>,</span>
<span>              <span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">Xnames</span> <span class="co">#Apply names</span></span>
<span></span>
<span><span class="co"># s = The standard deviations of variables in X</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">15</span>,<span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># k = The number of variables</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CM = Covariance Matrix</span></span>
<span><span class="co"># Initialize k by k matrix of zeroes</span></span>
<span><span class="va">CM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">k</span>, <span class="va">k</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">CM</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">CM</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">Xnames</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">CM</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="va">s</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">s</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">*</span> <span class="va">R</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">CM</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>      X1    X2    X3
X1 225.0 112.5 135.0
X2 112.5 225.0 157.5
X3 135.0 157.5 225.0</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>The <span class="math inline">\mathtt{diag}</span> function has three purposes. First, it can extract the diagonal vector from a matrix: <span class="math display">
A_{kk} =
\begin{bmatrix}
  a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1k} \\
  a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2k} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  a_{k1} &amp; a_{k2} &amp; \cdots &amp; a_{kk}
\end{bmatrix}
</span> Then <span class="math display">\mathtt{diag}(\boldsymbol{A}) = \{a_{11},a_{22},...,a_{kk}\}</span> Second, the <code>diag</code> function inserts a vector into the the diagonal of a <span class="math inline">k \times k</span> matrix of zeros: <span class="math display">
\mathtt{diag}(\boldsymbol{a}) =
\begin{bmatrix}
  a_{1} &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; a_{2} &amp; \cdots &amp; 0 \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  0 &amp; 0 &amp; \cdots &amp; a_{k}
\end{bmatrix}
</span> Third, the <code>diag</code> function converts integer <span class="math inline">k</span> into a <span class="math inline">k \times k</span> identity matrix: <span class="math display">
\mathtt{diag}(k) =
\begin{bmatrix}
  1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 1 &amp; \cdots &amp; 0 \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  0 &amp; 0 &amp; \cdots &amp; 1
\end{bmatrix}
</span></p>
</div></div><p>To calculate the covariance matrix in matrix notation, we can make use of the <span class="math inline">\mathtt{diag}</span> function.</p>
<p><span class="math display">
\begin{align*}
\boldsymbol{\Sigma}&amp;=\mathtt{diag}(\boldsymbol{\sigma}) \boldsymbol{R}\, \mathtt{diag}(\boldsymbol{\sigma})\\
&amp;=\begin{bmatrix}
  \sigma_{1} &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; \sigma_{2} &amp; \cdots &amp; 0 \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  0 &amp; 0 &amp; \cdots &amp; \sigma_{k}
\end{bmatrix}
  \begin{bmatrix}
  1 &amp; \rho_{12} &amp; \cdots &amp; \rho_{1k} \\
  \rho_{21} &amp; 1 &amp; \cdots &amp; \rho_{2k} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  \rho_{k1} &amp; \rho_{k2} &amp; \cdots &amp; 1
\end{bmatrix}
\begin{bmatrix}
  \sigma_{1} &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; \sigma_{2} &amp; \cdots &amp; 0 \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  0 &amp; 0 &amp; \cdots &amp; \sigma_{k}
\end{bmatrix}\\
  &amp;=  \begin{bmatrix}
  \sigma_{1}^2 &amp; \sigma_{1}\sigma_{2}\rho_{12} &amp; \cdots &amp; \sigma_{1}\sigma_{k}\rho_{1k} \\
  \sigma_{2}\sigma_{1}\rho_{21} &amp; \sigma_{2}^2 &amp; \cdots &amp; \sigma_{2}\sigma_{k}\rho_{2k} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  \sigma_{k}\sigma_{1}\rho_{k1} &amp; \sigma_{k}\sigma_{2}\rho_{k2} &amp; \cdots &amp; \sigma_{k}^2
\end{bmatrix}\\
   &amp;=  \begin{bmatrix}
  \sigma_{1}^2 &amp; \sigma_{12} &amp; \cdots &amp; \sigma_{1k} \\
  \sigma_{21} &amp; \sigma_{2}^2 &amp; \cdots &amp; \sigma_{2k} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  \sigma_{k1} &amp; \sigma_{k2} &amp; \cdots &amp; \sigma_{k}^2
\end{bmatrix}
\end{align*}
</span></p>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\boldsymbol{\Sigma}</span></td>
<td style="text-align: left;">The covariance matrix of variables in <span class="math inline">\boldsymbol{X}</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\boldsymbol{\sigma}</span></td>
<td style="text-align: left;">The standard deviations of variables in <span class="math inline">\boldsymbol{X}</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\boldsymbol{R}</span></td>
<td style="text-align: left;">The correlation matrix of variables in <span class="math inline">\boldsymbol{X}</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So this is where matrix algebra starts to shine. We do not need to initialize the variable that contains the covariance matrix, or calculate <span class="math inline">k</span>, or do any looping.</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb12" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># CM = Covariance matrix of variables in X</span></span>
<span><span class="va">CM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">R</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Beautiful!</p>
<p>Running the code, we get: <span class="math display">
\boldsymbol{\Sigma}=\begin{bmatrix}
225 &amp; 112.5 &amp; 135\\
112.5 &amp; 225 &amp; 157.5\\
135 &amp; 157.5 &amp; 225
\end{bmatrix}
</span></p>
<p>To calculate the variance of <span class="math inline">X_S</span> if it is an unweighted sum we apply Equation&nbsp;@ref(eq:VarianceOfASum):</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">

</div>
<p>Here we see that <span class="math inline">\sigma_X^2=1485</span></p>
</section><section id="calculating-the-variance-of-a-weighted-sum" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="calculating-the-variance-of-a-weighted-sum">
<span class="header-section-number">10.3</span> Calculating the Variance of a Weighted Sum</h2>
<p>If <span class="math inline">X_S</span> is a weighted sum, its variance is the weighted sum of the covariance matrix.</p>
<p><span class="math display">
\sigma_S^2=\sum_{i=1}^{k}{\sum_{j=1}^{k}{w_i w_j \sigma_{ij}}}=\boldsymbol{w'\Sigma w}
(\#eq:VarianceOfAWeightedSum)
</span></p>
<p>Continuing with the same variables in our example, we see that things are starting to become clumsy and ugly without matrix algebra:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb13" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># First we initialize var_S as 0</span></span>
<span><span class="va">var_S_weighted</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="co"># Now we loop through k rows and k columns of CM</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var_S_weighted</span> <span class="op">&lt;-</span> <span class="va">var_S_weighted</span> <span class="op">+</span> <span class="va">w</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">*</span> <span class="va">CM</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With matrix algebra, this all happens with a single line of code:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb14" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var_S_weighted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">CM</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">w</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we don’t need to know the covariance matrix, we can skip its calculation:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb15" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var_S_weighted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">w</span> <span class="op">*</span> <span class="va">s</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">R</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">w</span> <span class="op">*</span> <span class="va">s</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All three methods give the same answer: <span class="math inline">\sigma_X^2 = 2193.75</span></p>
</section><section id="calculating-a-composite-score" class="level2 page-columns page-full" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="calculating-a-composite-score">
<span class="header-section-number">10.4</span> Calculating a Composite Score</h2>
<p>We now have all of the information needed to make a composite score. First we will make an unweighted composite.</p>
<p><span class="math display">\begin{equation}
C = \frac{x_S-\mu_S}{\sigma_{X_S}}\sigma_C + \mu_C
(\#eq:Composite)
\end{equation}</span></p>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">C</span></td>
<td style="text-align: left;">The composite variable <span class="math inline">C</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">x_S</span></td>
<td style="text-align: left;">The sum of all <span class="math inline">k</span> scores in <span class="math inline">\{x_1,...,x_k\}</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\sigma_{X_S}</span></td>
<td style="text-align: left;">The standard deviation of <span class="math inline">X_S</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\sigma_C</span></td>
<td style="text-align: left;">The standard deviation of <span class="math inline">C</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\mu_C</span></td>
<td style="text-align: left;">The mean of <span class="math inline">C</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Continuing with our example, suppose that <span class="math inline">\mu_C=100</span> and <span class="math inline">\sigma_C=15.</span></p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb16" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># m_C = Composite mean</span></span>
<span><span class="va">m_C</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co"># s_C = Composite standard deviation</span></span>
<span><span class="va">s_C</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="co"># C = The composite score</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">x_S</span> <span class="op">-</span> <span class="va">m_S</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">var_S</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">s_C</span> <span class="op">+</span> <span class="va">m_C</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">
C=119
</span></p>
<section id="calculating-a-weighted-composite-score" class="level3 page-columns page-full" data-number="10.4.1"><h3 data-number="10.4.1" class="anchored" data-anchor-id="calculating-a-weighted-composite-score">
<span class="header-section-number">10.4.1</span> Calculating a Weighted Composite Score</h3>
<p>In matrix notation, an unweighted composite score is calculated like so:</p>
<p><span class="math display">
C=\boldsymbol{\frac{1'(x-\mu_x)}{\sqrt{1'\Sigma 1}}}\sigma_C+\mu_C
</span> Replacing each vector of ones <span class="math inline">\boldsymbol{1}</span> with a weight vector <span class="math inline">\boldsymbol{w}</span> gives us the formula for computing a weighted composite score:</p>
<p><span class="math display">
C_w=\boldsymbol{\frac{w'(x-\mu_x)}{\sqrt{w'\Sigma w}}}\sigma_C+\mu_C
</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>In clinical practice, the most common kind of composite score is an equally weighted composite consisting of scores with the same mean and standard deviation. Sometimes scores are weighted by the degree to which they correlate with the construct the composite is intended to measure. Other weighting schemes are also possible. In most cases, it makes sense to first convert all scores to z-scores and then weight the z-scores. Failing to convert the scores to a common metric such as z-scores will result in an implicit weighting by standard deviations. That is, the score with the largest standard deviation will have the most weight in the composite score. Converting to z-scores first will equalize the each score’s influence on the composite score. We can convert all the scores in <span class="math inline">\boldsymbol{x}</span> to z-scores like so:</p>
<p><span class="math display">
\boldsymbol{z} = \frac{\boldsymbol{x}-\boldsymbol{\mu}}{\boldsymbol{\sigma}}
</span></p>
<p>The nice thing about z-scores is that their means are zeros, their standard deviations are ones, and their covariances are correlations. Thus, the formula for a weighted composite score consisting of z-scores is fairly simple, especially if the composite score is a z-score itself:</p>
<p><span class="math display">
C = \frac{\boldsymbol{w^\prime z}}{\sqrt{\boldsymbol{w^\prime Rw}}}\sigma_C+\mu_C
</span></p>
</div></div><p>Continuing with our example, computing a composite score with <span class="math inline">X_1=110</span>, <span class="math inline">X_2=120</span>, and <span class="math inline">X_3=118</span>:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb17" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># C = The composite score</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">CM</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">w</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">15</span>  <span class="op">+</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># With index scores, we round to the nearest integer</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Notes:</span></span>
<span><span class="co"># The round function rounds to the nearest integer by default,</span></span>
<span><span class="co"># but you can round to any number of digits you wish. For example, </span></span>
<span><span class="co"># rounding to 2 significant digits (i.e., the hundredths place), </span></span>
<span><span class="co"># would be round(x,2).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we see, that the weighted composite score <span class="math inline">C = 120.</span> If we had wanted an equally weighted composite score, the <code>w</code> vector would be set to equal ones. If we had done so, <span class="math inline">C</span> would have been <span class="math inline">119</span> instead of <span class="math inline">120.</span></p>
</section></section><section id="the-reliability-coefficient-of-a-composite" class="level2" data-number="10.5"><h2 data-number="10.5" class="anchored" data-anchor-id="the-reliability-coefficient-of-a-composite">
<span class="header-section-number">10.5</span> The Reliability Coefficient of a Composite</h2>
<p>Calculating the reliability coefficient of a composite score is much easier than it might appear at first. Remember that reliability is the ratio of a score’s true score variance to its total variance:</p>
<p><span class="math display">
r_{XX} = \frac{\sigma_T^2}{\sigma_X^2}
</span></p>
<p>The variance of a composite score is the sum of the covariance matrix of the composite’s component scores.</p>
<p><span class="math display">
\sigma_X^2=\boldsymbol{1}'\begin{bmatrix}
  \sigma_{1}^2 &amp; \sigma_{12} &amp; \cdots &amp; \sigma_{1k} \\
  \sigma_{21} &amp; \sigma_{2}^2 &amp; \cdots &amp; \sigma_{2 k} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  \sigma_{k1} &amp; \sigma_{k2} &amp; \cdots &amp; \sigma_{k}^2
\end{bmatrix}\boldsymbol{1}
</span></p>
<p>The covariance matrix of the component true scores is exactly the same as the covariance matrix of the component observed scores, except that the variances on the diagonal are multiplied by the reliability coefficients of each of the component scores like so:</p>
<p><span class="math display">
\sigma_T^2=\boldsymbol{1}'\begin{bmatrix}
  {\color{firebrick}r_{11}}\sigma_{1}^2 &amp; \sigma_{12} &amp; \cdots &amp; \sigma_{1k} \\
  \sigma_{21} &amp; {\color{firebrick}r_{22}}\sigma_{2}^2 &amp; \cdots &amp; \sigma_{2 k} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  \sigma_{k1} &amp; \sigma_{k2} &amp; \cdots &amp; {\color{firebrick}r_{kk}}\sigma_{k}^2
\end{bmatrix}\boldsymbol{1}
</span></p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb18" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># r_XX = Reliability coefficients for X1, X2, and X3</span></span>
<span><span class="va">r_XX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.88</span>,<span class="fl">0.80</span>,<span class="fl">0.76</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CM_T = Covariance matrix of true scores</span></span>
<span><span class="va">CM_T</span> <span class="op">&lt;-</span> <span class="va">CM</span></span>
<span></span>
<span><span class="co"># Replace diagonal with true score variances</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">CM_T</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">CM</span><span class="op">)</span> <span class="op">*</span> <span class="va">r_XX</span></span>
<span></span>
<span><span class="co"># r_C = Reliability coefficient of composite score</span></span>
<span><span class="va">r_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">CM_T</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">CM</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The reliability coefficient of the unweighted composite is 0.92.</p>
<p>For a weighted composite, the reliability is calculated by relplacing each vector of ones <span class="math inline">\boldsymbol{1}</span> with a weight vector <span class="math inline">\boldsymbol{w}</span>:</p>
<p><span class="math display">
\rho_{XX}=\frac{\sigma_T^2}
               {\sigma_X^2}
         =\frac{\boldsymbol{w}^{\prime}
               \begin{bmatrix}
  {\color{firebrick}r_{11}}\sigma_{1}^2 &amp; \sigma_{12} &amp; \cdots &amp; \sigma_{1k} \\
  \sigma_{21} &amp; {\color{firebrick}r_{22}}\sigma_{2}^2 &amp; \cdots &amp; \sigma_{2 k} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  \sigma_{k1} &amp; \sigma_{k2} &amp; \cdots &amp; {\color{firebrick}r_{kk}}\sigma_{k}^2
                \end{bmatrix}
                \boldsymbol{w}}
          {\boldsymbol{w}^{\prime}
               \begin{bmatrix}
  \sigma_{1}^2 &amp; \sigma_{12} &amp; \cdots &amp; \sigma_{1k} \\
  \sigma_{21} &amp; \sigma_{2}^2 &amp; \cdots &amp; \sigma_{2 k} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  \sigma_{k1} &amp; \sigma_{k2} &amp; \cdots &amp; \sigma_{k}^2
\end{bmatrix}\boldsymbol{w}}
</span></p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb19" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Reliability coefficient of the weighted composite</span></span>
<span><span class="va">r_C_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">CM_T</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">w</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">CM</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">w</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The reliability coefficient of the weighted composite is 0.88.</p>
</section><section id="composite-scores-and-their-correlations" class="level2 page-columns page-full" data-number="10.6"><h2 data-number="10.6" class="anchored" data-anchor-id="composite-scores-and-their-correlations">
<span class="header-section-number">10.6</span> Composite Scores and Their Correlations</h2>
<p>If the population correlations among all of the components are known, it is possible to calculate the correlations among composite scores made from these components. Such correlations can be used in many practical applications, including in prediction models and in the evaluation of difference scores.</p>
<p>Suppose that Composite <span class="math inline">A</span> is calculated from the sum of two component tests, <span class="math inline">A_1</span> and <span class="math inline">A_2.</span> Composite <span class="math inline">B</span> is calculated from the sum of <span class="math inline">B_1</span> and <span class="math inline">B_2.</span> Suppose that the correlation matrix for the four components is:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">

</div>
<p><span class="math display">
\boldsymbol{R} = \begin{array}{r|cccc}
&amp; \color{royalblue}{A_1} &amp; \color{royalblue}{A_2} &amp; \color{firebrick}{B_1} &amp; \color{firebrick}{B_2}\\
\hline \color{royalblue}{A_1} &amp; \color{royalblue}{1} &amp; \color{royalblue}{.30} &amp; \color{purple}{.35} &amp; \color{purple}{.40}\\
\color{royalblue}{A_2} &amp; \color{royalblue}{.30} &amp; \color{royalblue}{1} &amp; \color{purple}{.42} &amp; \color{purple}{.48}\\
\color{firebrick}{B_1} &amp; \color{purple}{.35} &amp; \color{purple}{.42} &amp; \color{firebrick}{1} &amp; \color{firebrick}{.56}\\
\color{firebrick}{B_2} &amp; \color{purple}{.40} &amp; \color{purple}{.48} &amp; \color{firebrick}{.56} &amp; \color{firebrick}{1}
\end{array}
</span></p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb20" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Make correlation matrix R</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.30</span>, <span class="fl">.35</span>, <span class="fl">.40</span>,</span>
<span>              <span class="fl">.30</span>, <span class="fl">1</span>, <span class="fl">.42</span>, <span class="fl">.48</span>,</span>
<span>              <span class="fl">.35</span>, <span class="fl">.42</span>, <span class="fl">1</span>, <span class="fl">.56</span>,</span>
<span>              <span class="fl">.40</span>, <span class="fl">.48</span>, <span class="fl">.56</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>            nrow <span class="op">=</span> <span class="fl">4</span>,</span>
<span>            ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display R</span></span>
<span><span class="va">R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>     [,1] [,2] [,3] [,4]
[1,] 1.00 0.30 0.35 0.40
[2,] 0.30 1.00 0.42 0.48
[3,] 0.35 0.42 1.00 0.56
[4,] 0.40 0.48 0.56 1.00</code></pre>
</div>
</div>
<p>The correlation between Composite <span class="math inline">A</span> and Composite <span class="math inline">B</span> is calculating by adding up the numbers is all three shaded regions of the correlation matrix and then dividing the sum of “between” correlations in purple by the geometric mean of the sums from the “within” correlations in the blue and red regions in the correlation matrix <span class="math inline">\boldsymbol{R}</span> like so:</p>
<p><span class="math display">r_{AB}=\dfrac{\color{purple}{\text{Sum of Correlations between A and B}}}{\sqrt{\color{royalblue}{\text{Sum of Correlations Within A}}\times\color{firebrick}{{\text{Sum of Correlations Within B}}}}}</span></p>
<p>To calculate these sums using matrix algebra, we first construct a “weight matrix” <span class="math inline">\boldsymbol{W}</span> that tells us which tests are in which composite. The 1s in the first two rows of column 1 tell us that tests <span class="math inline">A_1</span> and <span class="math inline">A_2</span> belong to composite <span class="math inline">A</span>. Likewise, the 1s in the last two rows of column 2 tell us that <span class="math inline">B_1</span> and <span class="math inline">B_2</span> belong to composite <span class="math inline">B</span>.</p>
<p><span class="math display">
\boldsymbol{W}=
\begin{array}{r|cc}
&amp; \color{royalblue}{A} &amp; \color{firebrick}{B}\\
\hline \color{royalblue}{A_1} &amp; \color{royalblue}{1} &amp; 0\\
\color{royalblue}{A_2} &amp; \color{royalblue}{1} &amp; 0\\
\color{firebrick}{B_1} &amp; 0 &amp; \color{firebrick}{1}\\
\color{firebrick}{B_2} &amp; 0 &amp; \color{firebrick}{1}
\end{array}
</span></p>
<p>Here is one way to make the weight matrix in R:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb22" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Make a 4 by 2 matrix of 0s</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign 1s to rows 1 and 2 to column 1</span></span>
<span><span class="va">W</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># Assign 1s to rows 3 and 4 to column 2</span></span>
<span><span class="va">W</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Display W</span></span>
<span><span class="va">W</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>     [,1] [,2]
[1,]    1    0
[2,]    1    0
[3,]    0    1
[4,]    0    1</code></pre>
</div>
</div>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">

</div>
<p>The covariance matrix <span class="math inline">\boldsymbol{\Sigma_{AB}}</span> is calculated by pre- and post-mulitplying <span class="math inline">\boldsymbol{R}</span> by the wieght matrix .</p>
<p><span class="math display">
\begin{aligned}\boldsymbol{\Sigma_{AB}} &amp;= \boldsymbol{W'RW}\\[2ex]
&amp;=\left[\begin{array}{cc}
\color{royalblue}{1} &amp; 0\\
\color{royalblue}{1} &amp; 0\\
0 &amp; \color{firebrick}{1}\\
0 &amp; \color{firebrick}{1}
\end{array}\right]'\left[\begin{array}{cccc}
\color{royalblue}{1} &amp; \color{royalblue}{.30} &amp; \color{purple}{.35} &amp; \color{purple}{.40}\\
\color{royalblue}{.30} &amp; \color{royalblue}{1} &amp; \color{purple}{.42} &amp; \color{purple}{.48}\\
\color{purple}{.35} &amp; \color{purple}{.42} &amp; \color{firebrick}{1} &amp; \color{firebrick}{.56}\\
\color{purple}{.40} &amp; \color{purple}{.48} &amp; \color{firebrick}{.56} &amp; \color{firebrick}{1}
\end{array}\right]\left[\begin{array}{cc}
\color{royalblue}{1} &amp; 0\\
\color{royalblue}{1} &amp; 0\\
0 &amp; \color{firebrick}{1}\\
0 &amp; \color{firebrick}{1}
\end{array}\right]\\[2ex]
&amp;=\begin{array}{r|cc}
&amp; \color{royalblue}{A} &amp; \color{firebrick}{B}\\
\hline \color{royalblue}{A} &amp; \color{royalblue}{1 + .30 + .30 + 1} &amp; \color{purple}{.35 + .42 + .40 + .48}\\
\color{firebrick}{B} &amp; \color{purple}{.35 + .40 + .42 + .48} &amp; \color{firebrick}{1 + .56 + .56 + 1}
\end{array}\\[2ex]
&amp;=\begin{array}{r|cc}
&amp; \color{royalblue}{A} &amp; \color{firebrick}{B}\\
\hline \color{royalblue}{A} &amp; \color{royalblue}{2.60} &amp; \color{purple}{1.65}\\
\color{firebrick}{B} &amp; \color{purple}{1.65} &amp; \color{firebrick}{3.12}
\end{array}
\end{aligned}
</span></p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb24" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Covariance matrix of composites A and B</span></span>
<span><span class="va">Sigma_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">R</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">W</span></span>
<span></span>
<span><span class="co"># Display Sigma_AB</span></span>
<span><span class="va">Sigma_AB</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>     [,1] [,2]
[1,] 2.60 1.65
[2,] 1.65 3.12</code></pre>
</div>
</div>
<p>Now we need to extract the variance diagonal from the covariance matrix so that we can use them to convert the covariance matrix to a correlation matrix. The variances are put on a diagonal matrix, and then taking the square root converts the variances to standard deviations in matrix <span class="math inline">\boldsymbol{\sigma}</span>.</p>
<p><span class="math display">
\begin{aligned}
\boldsymbol{\sigma}
&amp;=\mathtt{diag}(\mathtt{diag}(\boldsymbol{\Sigma_{AB}}))^{\frac{1}{2}}\\
&amp;=\mathtt{diag}\left(
\mathtt{diag}\left({
\left[\begin{array}{cc}
\color{royalblue}{2.60} &amp; \color{purple}{1.65}\\
\color{purple}{1.65} &amp; \color{firebrick}{3.12}
\end{array}\right]
   }\right)
   \right)^{\frac{1}{2}}\\
   &amp;=\mathtt{diag}\left(
   \left[\begin{array}{c}
\color{royalblue}{2.60}\\
\color{firebrick}{3.12}
\end{array}\right]
   \right)^{\frac{1}{2}}\\
   &amp;=\left[\begin{array}{cc}
\color{royalblue}{2.60} &amp; 0\\
0 &amp; \color{firebrick}{3.12}
\end{array}\right]^{\frac{1}{2}}\\
   &amp;=\left[\begin{array}{cc}
\color{royalblue}{1.6125} &amp; 0\\
0 &amp; \color{firebrick}{1.7664}
\end{array}\right]
\end{aligned}
</span></p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb26" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Standard deviations</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">Sigma_AB</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display sigma</span></span>
<span><span class="va">sigma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>         [,1]     [,2]
[1,] 1.612452 0.000000
[2,] 0.000000 1.766352</code></pre>
</div>
</div>
<p>Pre- and post-multiplying the covariance matrix <span class="math inline">\boldsymbol{\Sigma_{AB}}</span> by the inverted standard devation matrix <span class="math inline">\boldsymbol{\sigma}</span> to yield the correlations between composites <span class="math inline">A</span> and <span class="math inline">B</span>.</p>
<p><span class="math display">
\begin{aligned}
\boldsymbol{R_{AB}}&amp;=\boldsymbol{\sigma}^{-1}\boldsymbol{\Sigma_{AB}}\boldsymbol{\sigma}^{-1}\\[2ex]
&amp;={\boldsymbol{\sigma}^{-1} \atop \left[\begin{array}{cc}
\color{royalblue}{1.6125} &amp; 0\\
0 &amp; \color{firebrick}{1.7664}
\end{array}\right]^{-1}}
   {\boldsymbol{\Sigma_{AB}} \atop \left[\begin{array}{cc}
\color{royalblue}{2.60} &amp; \color{purple}{1.65}\\
\color{purple}{1.65} &amp; \color{firebrick}{3.12}
\end{array}\right]}
   {\boldsymbol{\sigma}^{-1} \atop \left[\begin{array}{cc}
\color{royalblue}{1.6125} &amp; 0\\
0 &amp; \color{firebrick}{1.7664}
\end{array}\right]^{-1}}\\[1ex]
&amp;=\left[\begin{array}{cc}
\color{royalblue}{.6202} &amp; 0\\
0 &amp; \color{firebrick}{.5661}
\end{array}\right]
   \left[\begin{array}{cc}
\color{royalblue}{2.60} &amp; \color{purple}{1.65}\\
\color{purple}{1.65} &amp; \color{firebrick}{3.12}
\end{array}\right]
   \left[\begin{array}{cc}
\color{royalblue}{.6202} &amp; 0\\
0 &amp; \color{firebrick}{.5661}
\end{array}\right]\\[1ex]
&amp;=\left[\begin{array}{cc}
\color{royalblue}{1} &amp; \color{purple}{.58}\\
\color{purple}{.58} &amp; \color{firebrick}{1}
\end{array}\right]
\end{aligned}
</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The <code>solve</code> function inverts a square matrix. Inverting a single number <span class="math inline">x</span> gives its reciprocal. If you multiply the inverse of a number by the nunbe itself, you get 1, the <em>identity</em> for the multiplication operator. <span class="math inline">x^{-1}x=1</span>, multiplying a matrix by its inverse creates an identity matrix (a matrix with ones on the diagonal and zeroes elsewhere):</p>
<p><span class="math display">\boldsymbol{A^{-1}A = I}</span></p>
</div></div><div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb28" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Correlations between composites A and B</span></span>
<span><span class="va">R_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Sigma_AB</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span></span>
<span><span class="va">R_AB</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>          [,1]      [,2]
[1,] 1.0000000 0.5793219
[2,] 0.5793219 1.0000000</code></pre>
</div>
</div>
<p>These calculations in R can be greatly simplified using the <code>cov2cor</code> function, which converts covariances to correlations:</p>
<div class="cell fig-cap-location-margin tbl-cap-location-margin" data-layout-align="center">
<div class="sourceCode" id="cb30" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Correlation matrix of composites A and B</span></span>
<span><span class="va">R_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">R</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">W</span><span class="op">)</span></span>
<span></span>
<span><span class="va">R_AB</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="margin"><code>          [,1]      [,2]
[1,] 1.0000000 0.5793219
[2,] 0.5793219 1.0000000</code></pre>
</div>
</div>



</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./descriptives.html" class="pagination-link" aria-label="Descriptives">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Descriptives</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./unfinished.html" class="pagination-link" aria-label="Unfinished Odds and Ends">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Unfinished Odds and Ends</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>